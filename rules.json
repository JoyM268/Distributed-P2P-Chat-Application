{
	"rules": {
		"users": {
			".indexOn": ["email", "username"],
			"$uid": {
				".read": "auth != null",
				".write": "auth != null && auth.uid === $uid",

				"email": {
					".read": true
				},
				"private": {
					".read": false
				}
			}
		},

		"usernames": {
			"$username": {
				".read": true,
				".write": "auth != null && (!data.exists() || data.val() === auth.uid)",
				".validate": "!newData.exists() || newData.val() === auth.uid"
			}
		},

		"friends": {
			"$uid": {
				".read": "auth != null && auth.uid === $uid",
				".write": "auth != null && auth.uid === $uid",

				"$friendUid": {
					".write": "auth != null && (auth.uid === $uid || auth.uid === $friendUid)",
					".validate": "!newData.exists() || newData.val() === true"
				}
			}
		},

		"friend_requests": {
			"$uid": {
				".read": "auth != null && auth.uid === $uid",
				".write": "auth != null",

				"$senderUid": {
					".validate": "!newData.exists() || auth.uid === $senderUid || auth.uid === $uid"
				}
			}
		},

		"status": {
			"$uid": {
				".read": "auth != null",
				".write": "auth != null && auth.uid === $uid"
			}
		},

		"signaling": {
			"$receiverUid": {
				".read": "auth != null && auth.uid === $receiverUid",
				".write": "auth != null",

				"$signalId": {
					".validate": "newData.exists()"
				}
			}
		}
	}
}
